记图 ![math](https://www.zhihu.com/equation?tex=S) 进行一次变化后（不出错）为 ![math](https://www.zhihu.com/equation?tex=f%28S%29) ， ![math](https://www.zhihu.com/equation?tex=%7CS%7C%3D%5Csum_%7Bu%5Cin%20S%7D%5Bu%3D1%5D) 。

显然不存在 ![math](https://www.zhihu.com/equation?tex=%7Cf%28S%29%7C%3D2) 的 ![math](https://www.zhihu.com/equation?tex=S) 。

所以每一步是唯一的。

搜索即可， ![math](https://www.zhihu.com/equation?tex=O%28n%5E3%29%5Csim%20O%28n%5E5%29) 。
